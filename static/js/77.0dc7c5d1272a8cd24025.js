(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{WH4p:function(e,a,t){"use strict";t.r(a);var l={name:"addUser",props:{outTypes:{type:Array,default:function(){return[]}},dialogVisible:{type:Boolean,default:!1},carOptions:{type:Array,default:function(){return[]}},areaTree:{type:Array,default:function(){return[]}},addUserForm2:{type:Object,default:function(){}},justLook:{type:Boolean,default:!1}},data:function(){var e=this;return{rules:{portOneLevelId:[{required:!0,validator:function(a,t,l){""===e.addUserForm.portOneLevelId&&""===e.addUserForm.portTwoLevelId||e.addUserForm.portOneLevelId?l():l(new Error("请选择所属区域"))},trigger:"blur"}],vehicleType:this.$rules.selectOne(this.carOptions,"请选择车辆类型"),ioType:this.$rules.selectOne(this.outTypes,"请选择出入境类型"),account:this.$rules.validate("请输入登录账号",16),roleIds:[{required:!0,validator:function(a,t,l){e.roleIds.length?l():l(new Error("请选择所属角色"))},trigger:"blur"}],userName:this.$rules.validate("请输入用户名称",10),enable:[{required:!0,message:"请选择是否启用",trigger:"blur"}],remark:this.$rules.validate("",50,!1),email:this.$rules.validate("",20,!1),phoneNumber:this.$rules.validate("",20,!1)},enableOptions:[{label:"启用",value:!0},{label:"禁用",value:!1}],sites:"",roles:[],roleIds:[],visible:this.dialogVisible,addUserForm:this.addUserForm2,formLabelWidth:"94px",departmentOptions:[],userRoleOptions:[]}},mounted:function(){console.log(this.carOptions),this.getRoleData(),this.addUserForm.guid&&(this.sites=this.$getInitSitArr(this.addUserForm.portOneLevelId,this.addUserForm.portTwoLevelId,this.areaTree))},methods:{selelectChange:function(){console.log(this.addUserForm.roleIds)},changeSite:function(){this.addUserForm.portOneLevelId=this.$getPortId(1,this.sites,this.areaTree),this.addUserForm.portTwoLevelId=this.$getPortId(2,this.sites,this.areaTree),this.$refs.cascaderHandle.dropDownVisible=!1},getRoleData:function(){var e=this,a={};this.addUserForm.guid&&(a.guid=this.addUserForm.guid),this.$request.getRoleInfo(a).then((function(a){var t=[];if(a.data.forEach((function(e,a){var l={};e.choose?(l.check=e.check,l.label=e.roleName,l.value=e.guid,l.guid=e.guid,t.push(l)):e.check&&(l.check=e.check,l.label=e.roleName,l.value=e.guid,l.guid=e.guid,l.disabled="disabled",l.notchoose=!0,t.push(l))})),e.addUserForm.guid){var l=[];a.data.forEach((function(e,a){e.check&&e.enable&&l.push(e.guid)})),e.roleIds=l}console.log(e.addUserForm.roleIds),console.log(t),e.roles=t,e.hideClose()}))},hideClose:function(){var e=[];this.roles.forEach((function(a,t){a.check&&e.push(a)})),e.length&&this.$nextTick((function(){e.forEach((function(e,a){e.disabled&&(document.querySelectorAll(".el-tag__close")[a].style.display="none")}))}))},submitRole:function(){var e=this;this.$refs.ruleForm.validate((function(a){if(!a)return!1;e.addUserForm2.guid?(delete e.addUserForm2.modifiedTime,delete e.addUserForm2.createTime,e.$request.editUser(e.addUserForm2).then((function(a){e.$message({type:"success",message:a.data}),e.$emit("updateAction",e.addUserForm2),e.closeCallback()}))):e.$request.addNewUser(e.addUserForm2).then((function(a){e.$emit("addCallBack"),e.$message({type:"success",message:a.data}),e.closeCallback()}))}))},closeCallback:function(){this.$emit("editCallback")}},watch:{roleIds:function(e,a){this.addUserForm.roleIds=e}}},r=(t("efYB"),t("jsue"),t("KHd+")),s=Object(r.a)(l,(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("el-dialog",{attrs:{"close-on-click-modal":e.justLook,width:"900px",visible:e.visible,"destroy-on-close":""},on:{"update:visible":function(a){e.visible=a},close:e.closeCallback}},[t("div",{staticClass:"dialogTitleDiy"},[e._v(e._s(e.justLook?"查看用户":e.addUserForm.guid?"编辑用户":"添加用户"))]),e._v(" "),t("div",{staticClass:"addUserForm"},[t("el-form",{ref:"ruleForm",attrs:{disabled:e.justLook,"hide-required-asterisk":e.justLook,rules:e.rules,model:e.addUserForm,"label-width":"96px"}},[t("div",{staticClass:"addWrap"},[t("div",{staticClass:"left"},[t("el-form-item",{class:!e.justLook&&e.addUserForm.guid?"disabled2":"",attrs:{label:"登录账号:",prop:"account"}},[t("el-input",{attrs:{disabled:!!e.addUserForm.guid,placeholder:"请输入登录账号"},model:{value:e.addUserForm.account,callback:function(a){e.$set(e.addUserForm,"account",a)},expression:"addUserForm.account"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"所属区域:",prop:"portOneLevelId"}},[e.justLook?t("el-input",{attrs:{type:"text",value:e.$getSite(e.addUserForm.portOneLevelId,e.addUserForm.portTwoLevelId,e.areaTree)}}):t("el-cascader",{ref:"cascaderHandle",attrs:{clearable:!1,placeholder:"请选择所属区域",options:e.areaTree,props:{checkStrictly:!0}},on:{change:e.changeSite},model:{value:e.sites,callback:function(a){e.sites=a},expression:"sites"}})],1),e._v(" "),t("div",{staticClass:"halfWrap"},[t("el-form-item",{staticClass:"half",attrs:{label:"出入境类型:",prop:"ioType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择出入境类型"},model:{value:e.addUserForm.ioType,callback:function(a){e.$set(e.addUserForm,"ioType",a)},expression:"addUserForm.ioType"}},e._l(e.outTypes,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),t("el-form-item",{staticClass:"half",attrs:{label:"车辆类型:",prop:"vehicleType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择车辆类型"},model:{value:e.addUserForm.vehicleType,callback:function(a){e.$set(e.addUserForm,"vehicleType",a)},expression:"addUserForm.vehicleType"}},e._l(e.carOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),t("div",{staticClass:"halfWrap"},[t("el-form-item",{staticClass:"half",attrs:{label:"用户名称:",prop:"userName"}},[t("el-input",{attrs:{placeholder:"请输入用户名称"},model:{value:e.addUserForm.userName,callback:function(a){e.$set(e.addUserForm,"userName",a)},expression:"addUserForm.userName"}})],1),e._v(" "),t("el-form-item",{staticClass:"half",attrs:{label:"是否启用:",prop:"enable"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择启用状态"},model:{value:e.addUserForm.enable,callback:function(a){e.$set(e.addUserForm,"enable",a)},expression:"addUserForm.enable"}},e._l(e.enableOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),t("div",{staticClass:"halfWrap"},[t("el-form-item",{staticClass:"half",attrs:{label:"邮箱:",prop:"email"}},[t("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.addUserForm.email,callback:function(a){e.$set(e.addUserForm,"email",a)},expression:"addUserForm.email"}})],1),e._v(" "),t("el-form-item",{staticClass:"half",attrs:{label:"联系方式:",prop:"phoneNumber"}},[t("el-input",{attrs:{placeholder:"请输入联系方式"},model:{value:e.addUserForm.phoneNumber,callback:function(a){e.$set(e.addUserForm,"phoneNumber",a)},expression:"addUserForm.phoneNumber"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"备注:",prop:"remark"}},[t("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.addUserForm.remark,callback:function(a){e.$set(e.addUserForm,"remark",a)},expression:"addUserForm.remark"}})],1)],1),e._v(" "),t("div",{staticClass:"right"},[e.roles&&e.roles.length?t("el-form-item",{staticStyle:{width:"92%"},attrs:{label:"所属角色:",prop:"roleIds"}},[t("el-select",{attrs:{size:"medium",clearable:!1,multiple:"",placeholder:"请选择角色"},on:{change:e.selelectChange},model:{value:e.roleIds,callback:function(a){e.roleIds=a},expression:"roleIds"}},e._l(e.roles,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,disabled:e.disabled,value:e.value}})})),1)],1):e._e()],1)])])],1),e._v(" "),e.justLook?e._e():t("div",{staticClass:"btn block"},[t("el-button",{attrs:{type:"primary"},on:{click:e.submitRole}},[e._v(e._s(e.addUserForm.guid?"编辑":"添加"))]),e._v(" "),t("el-button",{attrs:{type:"info"},on:{click:e.closeCallback}},[e._v("取消")])],1)])}),[],!1,null,"bf45941a",null);a.default=s.exports},efYB:function(e,a,t){"use strict";t("o/pB")},jsue:function(e,a,t){"use strict";t("wLBQ")},"o/pB":function(e,a,t){},wLBQ:function(e,a,t){}}]);