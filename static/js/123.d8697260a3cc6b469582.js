(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{"1zKh":function(e,t,s){"use strict";s.r(t);var n=s("XJYT"),a={name:"versionControl",props:{versionVisible:{type:Boolean,default:!1}},data:function(){return{tableList:[],versionVisible2:this.versionVisible,editData:this.editRemote,editVisible:this.editDialogVisible}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;this.$request.getRemoteChannelVersionList({project:"LTFront"}).then((function(t){e.tableList=t.data}))},selectBack:function(e){var t=this,s="已发布"===e.status?"取消发布":"发布";this.$confirm("确定"+s+"?","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){var s={project:"LTFront",versionName:e.versionName,status:e.status},a=null;"已发布"!==e.status&&(a=n.Loading.service({fullscreen:!1,lock:!0,text:"正在发布版本...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.3)",target:".el-dialog"})),t.$request.remoteChannelSwitchState(s).then((function(s){s.data.obj.success?(t.$message({message:"已发布"===e.status?"取消发布成功!":"发布成功!",type:"success"}),"已发布"!==e.status&&a.close(),t.getData()):(t.$message({message:s.data.obj.error,type:"info"}),"已发布"!==e.status&&a.close())})).catch((function(){}))})).catch((function(e){}))},deleteOne:function(e){var t=this;this.$confirm("确定删除？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.$request.remoteChannelDelete({versionName:e.versionName}).then((function(e){e.data.obj.success?(t.$message({message:"删除成功!",type:"success"}),t.getData()):t.$message({message:e.data.obj.response,type:"info"})}))})).catch((function(){}))},changeFile:function(e,t){var s=this;console.log(e,t),this.$confirm("确定上传"+e.name+"？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){var t=n.Loading.service({fullscreen:!1,lock:!0,text:"正在上传文件...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.3)",target:".el-dialog"});s.$request.remoteChannelUploadFile({file:e.raw}).then((function(e){e.data.obj.success?(s.$message({message:"上传成功!",type:"success"}),s.getData()):s.$message({message:e.data.obj.error,type:"info"}),t.close()})).catch((function(){t.close()}))})).catch((function(e){}))},handleExceed:function(e,t){},upload:function(){},closeEdit:function(){this.$emit("closeVersion")}}},o=(s("aV09"),s("KHd+")),i=Object(o.a)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{staticClass:"test",attrs:{"close-on-click-modal":!1,center:"","lock-scroll":!1,width:"70%",visible:e.versionVisible2,"destroy-on-close":""},on:{"update:visible":function(t){e.versionVisible2=t},close:e.closeEdit}},[s("div",{staticClass:"dialogTitleDiy"},[e._v("版本管理")]),e._v(" "),s("div",{staticClass:"uploadWrap"},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{accept:"application/zip",multiple:!1,action:"/autoupgrade/upload?project=LTFront","auto-upload":!1,"on-change":e.changeFile,"on-exceed":e.handleExceed,"show-file-list":!1}},[s("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload2"}},[e._v("点击上传")]),e._v(" "),s("div",{staticClass:"el-upload__tip2",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传zip文件")])],1)],1),e._v(" "),s("el-table",{attrs:{data:e.tableList,size:"small","max-height":"500"}},[s("el-table-column",{attrs:{prop:"versionId",label:"版本号"}}),e._v(" "),s("el-table-column",{attrs:{prop:"versionName",label:"版本名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("Tag",{attrs:{type:"已发布"===t.row.status?"success":"danger"}},[e._v(e._s(t.row.status))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"pubTime",label:"发布时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e.$getLocalTime(t.row.pubTime))+"\n            ")]}}])}),e._v(" "),e.$showColumn(["look"])?s("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return["已发布"===t.row.status?s("Icon",{directives:[{name:"stat",rawName:"v-stat",value:"look",expression:"'look'"}],attrs:{icon:"icon-fanhui",tip:"取消发布"},nativeOn:{click:function(s){return e.selectBack(t.row)}}}):e._e(),e._v(" "),"已发布"!==t.row.status?s("Icon",{directives:[{name:"stat",rawName:"v-stat",value:"look",expression:"'look'"}],attrs:{icon:"icon-icon_fabu",tip:"发布"},nativeOn:{click:function(s){return e.selectBack(t.row)}}}):e._e(),e._v(" "),"已发布"!==t.row.status?s("Icon",{directives:[{name:"stat",rawName:"v-stat",value:"look",expression:"'look'"}],attrs:{icon:"icon-shanchu",tip:"删除"},nativeOn:{click:function(s){return e.deleteOne(t.row)}}}):e._e()]}}],null,!1,4249970691)}):e._e()],1)],1)}),[],!1,null,"089af842",null);t.default=i.exports},aV09:function(e,t,s){"use strict";s("nYki")},nYki:function(e,t,s){}}]);