(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-736c6396"],{2017:function(e,t,n){"use strict";n("cafe")},"5ecb":function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return p}));var o=n("b775");function a(e){return Object(o["a"])({url:"/authorization/system/licence/download/".concat(e),method:"get"})}function r(){return Object(o["a"])({url:"/authorization/system/license/type",method:"get"})}function i(e){return Object(o["a"])({url:"/license/file/upload",method:"post",data:e})}function s(e){return Object(o["a"])({url:"/authorization/system/generate/licence/".concat(e.licenseId),method:"get",params:e})}function c(e){return Object(o["a"])({url:"/authorization/system/page",method:"get",params:e})}function u(e){return Object(o["a"])({url:"/authorization/system/enterprise/license/can/bound",method:"get",params:e})}function l(e){return Object(o["a"])({url:"/authorization/system/license",method:"post",data:e})}function d(e){return console.log(e,"equipmentId"),Object(o["a"])({url:"/authorization/license/equipment/generate/licence/".concat(e),method:"get"})}function p(e){return console.log(e,"token-license"),Object(o["a"])({url:"/authorization/license/equipment/licence/download/".concat(e),method:"get"})}},"6f4d":function(e,t,n){},"9ed6":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"container",staticClass:"login-container",style:"background-image: url("+e.bgImage+")"},[n("div",{staticClass:"header"},[n("div",{staticClass:"logo"}),n("div",{staticClass:"desktop"},[n("div",{staticClass:"activedlicense"},[n("el-upload",{staticClass:"upload-demo",attrs:{"on-success":e.handleSuccess,"before-upload":e.handleLicense,"http-request":e.handRequest,action:"","file-list":e.fileList,"show-file-list":!1}},[n("el-button",{staticClass:"licensetext",attrs:{size:"medium",type:"text"}},[e._v("License激活")])],1)],1),n("router-link",{attrs:{to:"/clientdownload"}},[e._v("客户端下载")])],1)]),n("el-card",[n("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,autocomplete:"on","label-position":"left"}},[n("div",{staticClass:"title-container"},[n("img",{attrs:{src:e.logoImage,alt:""}}),n("h3",{staticClass:"title"},[e._v(e._s(e.deptInfo.deptName||"BIMGO设计云"))])]),n("el-form-item",{attrs:{prop:"username"}},[n("span",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"user"}})],1),n("el-input",{ref:"username",attrs:{placeholder:"账号",name:"username",type:"text",tabindex:"1",autocomplete:"on"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),n("el-tooltip",{attrs:{content:"Caps lock is On",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[n("el-form-item",{attrs:{prop:"password"}},[n("span",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"password"}})],1),n("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"密码",name:"password",tabindex:"2",autocomplete:"on"},on:{blur:function(t){e.capsTooltip=!1}},nativeOn:{keyup:[function(t){return e.checkCapslock(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}]},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),n("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[n("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1)],1),n("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("登录 ")]),n("div",{staticClass:"powered-by"},[e._v("Powered by 立方数科股份有限公司")])],1)],1)],1)},a=[],r=n("1da1"),i=n("5530"),s=(n("96cf"),n("d3b7"),n("b64b"),n("b0c0"),n("c24f")),c=n("fcb7"),u=n("2f62"),l=n("d791"),d=n("5ecb"),p={name:"Login",props:{codename:{type:String,default:""}},data:function(){return{fileList:[],captchaUrl:"",clientDesktopUrl:window._URL_.WINDOW_EXE_PATH,loginForm:{username:"",password:"",captcha:"10000",key:"10000"},loginRules:{username:[{required:!0,trigger:"blur",message:"用户名不能为空"}],password:[{required:!0,trigger:"blur",message:"密码不能为空"}],captcha:[{required:!0,trigger:"change",message:"验证码不能为空"}]},passwordType:"password",capsTooltip:!1,loading:!1,showDialog:!1,redirect:void 0,otherQuery:{},logoImage:"",bgImage:""}},computed:Object(i["a"])({},Object(u["c"])({code:function(e){return e.dept.code},path:function(e){return e.dept.path},deptInfo:function(e){return e.dept.deptInfo}})),watch:{$route:{handler:function(e){var t=e.query;t&&(this.redirect=t.redirect,this.otherQuery=this.getOtherQuery(t))},immediate:!0}},created:function(){if(console.log(this.deptInfo),this.deptInfo){var e=this.deptInfo,t=e.logo,n=e.bgImage;this.logoImage=t||"/static/img/logo.png",this.bgImage=n||"/static/img/bg.png"}else this.setDefaultPic()},mounted:function(){""===this.loginForm.username?this.$refs.username.focus():""===this.loginForm.password&&this.$refs.password.focus()},methods:{handleSuccess:function(e){console.log(e,"file")},handRequest:function(e){var t=new FormData;t.append("file",e.file),Object(d["b"])(t).then((function(e){console.log(e,"log")})).catch((function(e){console.log(e,"err")}))},setDefaultPic:function(){this.logoImage="/static/img/logo.png",this.bgImage="/static/img/bg.png"},getCaptcha:function(){var e=this;Object(s["a"])().then((function(t){e.captchaUrl=t.data.img,e.loginForm.key=t.data.key}))},checkCapslock:function(e){var t=e.key;this.capsTooltip=t&&1===t.length&&t>="A"&&t<="Z"},showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0,e.$store.dispatch("user/login",e.loginForm).then((function(){e.$router.push({path:e.redirect||e.path+"/",query:e.otherQuery}),e.loading=!1})).catch((function(){e.loading=!1}))}))},getOtherQuery:function(e){return Object.keys(e).reduce((function(t,n){return"redirect"!==n&&(t[n]=e[n]),t}),{})},handleLicense:function(e){var t=e.name.indexOf(".");if(-1!=t)return this.$message({message:"上传License文件格式不对",type:"error"}),!1;this.$message({message:"上传成功",type:"success"})},getDeptInfo:function(e){var t=this;Object(c["l"])(e).then((function(e){var n=e.data,o=n.logo,a=n.bgImage;t.logoImage=Object(c["r"])(o),t.bgImage=Object(c["r"])(a)}))},getPackage:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l["e"])();case 3:n=t.sent,n.msg?(e.downloadFileURL=Object(l["c"])(n.msg),e.downloadDefaultEXE(e.downloadFileURL)):e.downloadDefaultEXE(),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.downloadDefaultEXE();case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},downloadDefaultEXE:function(e){var t=e||window._URL_.WINDOW_EXE_PATH,n=document.createElement("a");n.style.display="none",n.target="_blank",n.href=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}}},f=p,g=(n("2017"),n("f507"),n("2877")),m=Object(g["a"])(f,o,a,!1,null,"3abd8d10",null);t["default"]=m.exports},cafe:function(e,t,n){},d791:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return f}));var o=n("b775"),a=n("4328"),r=n.n(a),i=n("ed08"),s=n("01ea");function c(e){return Object(o["a"])({url:"/client/package/page",method:"get",params:e})}function u(e){return Object(o["a"])({url:"/client/package/activate",method:"put",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:r.a.stringify(e)})}function l(e){return Object(o["a"])({url:"/client/package/upgrade/".concat(e),method:"get",responseType:"blob"})}function d(e){return Object(i["b"])(s["a"],"/client/package/downClient/".concat(e))}function p(e){return Object(o["a"])({url:"/client/package/upload",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function f(){return Object(o["a"])({url:"/client/package/new/name",method:"get"})}},f507:function(e,t,n){"use strict";n("6f4d")}}]);