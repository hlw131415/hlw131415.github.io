(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{"4QGJ":function(e,t,a){"use strict";a("PorQ")},Dv9N:function(e,t,a){},"F/gZ":function(e,t,a){"use strict";a("tbwQ")},KdkF:function(e,t,a){"use strict";a("Dv9N")},NrlT:function(e,t,a){"use strict";a.r(t);var l,s=a("YEIV"),i=a.n(s),n=a("t2rG"),r=a.n(n),o={name:"editRule",props:{sortName:{type:Object,default:function(){}},channelList:{type:Array,default:function(){return[]}},dialogVisible:{type:Boolean,default:!1},ruleNameOne:{type:Object,default:function(){}},justLook:{type:Boolean,default:!1}},data:function(){return{dragOptions:{animation:200,group:"description",disabled:!1,ghostClass:"ghost"},ruleName:this.ruleNameOne,enableList:[{label:"启用",value:!0},{label:"停用",value:!1}],dragList:[],myArray:[],sortName2:{},checkList:[],enableOptions:[{value:!0,label:"启用"},{value:!1,label:"停用"}],visible:this.dialogVisible,ruleNameObj:[]}},mounted:function(){var e=this;if(console.log(this.ruleName),this.ruleName.id)this.$request.getOnePageRule({id:this.ruleName.id}).then((function(t){e.getSelect(t.data),console.log(e.ruleNameObj)}));else{this.ruleName={bjOrder:2,channelName:"",channelNo:"",enable:!0,healthOrder:1,hgOrder:3,orderArr:[{enable:!0,name:"healthOrder",value:1},{enable:!0,name:"bjOrder",value:2},{enable:!0,name:"hgOrder",value:3}]};this.getSelect({hgDataList:[],healthDataList:[],bjDataList:[]})}},computed:{disabledAll:function(){return!!this.justLook||!(!this.ruleName||this.ruleName.enable)}},methods:(l={getSelect:function(e){var t=this;this.$request.getOnePageRuleSelect({id:this.ruleName.id}).then((function(a){var l=a.data;e.selectableList=l,t.ruleNameObj=t.sortArr(t.delData(e)),console.log(t.ruleNameObj)}))},changeGroup:function(e,t){console.log(e);var a=this.ruleNameObj[t],l=e.length,s=l===a.selectList.length;this.$set(this.ruleNameObj[t],"checkAll",s);var i=l>0&&l<a.selectList.length;this.$set(this.ruleNameObj[t],"indeterminate",i),console.log(this.ruleNameObj[t])},handleCheckAllChange:function(e,t){e?this.$set(this.ruleNameObj[t],"choose",this.getAllCheck(this.copySimple(this.ruleNameObj[t].selectList))):this.$set(this.ruleNameObj[t],"choose",[]),this.$set(this.ruleNameObj[t],"indeterminate",!1)},getAllCheckList:function(e){return e.forEach((function(t,a){e[a].check=!0})),e},getAllCheck:function(e){var t=[];return e.forEach((function(e,a){t.push(e.key)})),t},delData:function(e){return[{indeterminate:e.hgDataList&&e.hgDataList.length>0&&e.hgDataList.length!==e.selectableList.length,checkAll:e.hgDataList&&e.hgDataList.length===e.selectableList.length,sort:this.ruleName.hgOrder,enable:this.ruleName.enableHg,name:"hgDataList",orderName:"hgOrder",choose:e.hgDataList||[],selectList:this.getSelectList(e.hgDataList,e.selectableList)},{indeterminate:e.healthDataList&&e.healthDataList.length>0&&e.healthDataList.length!==e.selectableList.length,checkAll:e.healthDataList&&e.healthDataList.length===e.selectableList.length,sort:this.ruleName.healthOrder,enable:this.ruleName.enableHealth,name:"healthDataList",orderName:"healthOrder",choose:e.healthDataList||[],selectList:this.getSelectList(e.healthDataList,e.selectableList)},{indeterminate:e.bjDataList&&e.bjDataList.length>0&&e.bjDataList.length!==e.selectableList.length,checkAll:e.bjDataList&&e.bjDataList.length===e.selectableList.length,sort:this.ruleName.bjOrder,enable:this.ruleName.enableBj,name:"bjDataList",orderName:"bjOrder",choose:e.bjDataList||[],selectList:this.getSelectList(e.bjDataList,e.selectableList)}]},sortArr:function(e){return e.sort((function(e,t){return e.sort-t.sort})),e},getEnable:function(e){return!this.justLook&&!!e},getSelectList:function(e,t){var a=this.copySimple(t);return e?(a.forEach((function(t,l){a[l].check=!1,e.forEach((function(e,s){t.key===e&&(a[l].check=!0)}))})),a):a},dragEnd:function(e){console.log(this.ruleNameObj)},getOrder:function(e){var t=0;return this.ruleNameObj.forEach((function(a,l){a.orderName===e&&(t=l+1)})),t}},i()(l,"getEnable",(function(e){var t=!1;return this.ruleNameObj.forEach((function(a,l){a.orderName===e&&(t=a.enable)})),t})),i()(l,"getCheckList",(function(e){var t=[];return this.ruleNameObj.forEach((function(a,l){a.name===e&&(t=a.choose)})),t})),i()(l,"getChannelName",(function(e){var t="";return this.channelList.forEach((function(a,l){e===a.value&&(t=a.label)})),t})),i()(l,"submitDicForm",(function(){var e=this;console.log(this.ruleName);var t={enable:this.ruleName.enable,channelNo:this.ruleName.channelNo,channelName:this.getChannelName(this.ruleName.channelNo),hgOrder:this.getOrder("hgOrder"),healthOrder:this.getOrder("healthOrder"),bjOrder:this.getOrder("bjOrder"),hgDataList:this.getCheckList("hgDataList"),healthDataList:this.getCheckList("healthDataList"),bjDataList:this.getCheckList("bjDataList"),enableHg:this.getEnable("hgOrder"),enableHealth:this.getEnable("healthOrder"),enableBj:this.getEnable("bjOrder")};this.ruleName.id?(t.id=this.ruleName.id,this.$request.updatePageRule(t).then((function(a){e.$emit("editSuccess",t),e.$message({type:"success",message:a.data}),e.closeCallback()}))):(console.log(!this.ruleName.channelNo),this.ruleName.channelNo?this.$request.addPageRule(t).then((function(t){e.$emit("addCallBack"),e.$message({type:"success",message:t.data}),e.closeCallback()})):this.$message({type:"warning",message:"请选择通道"}))})),i()(l,"closeCallback",(function(){this.$emit("editCallback")})),l),components:{draggable:r.a}},c=(a("F/gZ"),a("KdkF"),a("4QGJ"),a("KHd+")),h=Object(c.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"editRuleWrap",attrs:{"close-on-click-modal":e.justLook,width:"900px",visible:e.visible,"destroy-on-close":""},on:{"update:visible":function(t){e.visible=t},close:e.closeCallback}},[a("div",{staticClass:"dialogTitleDiy"},[e._v(e._s(e.justLook?"查看业务时序":e.ruleName&&e.ruleName.id?"编辑业务时序":"添加业务时序"))]),e._v(" "),a("div",{staticClass:"ruleNameObj"},[a("el-form",{ref:"form",staticClass:"formCls",attrs:{"hide-required-asterisk":e.justLook,inline:"",model:e.ruleName,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"通道:"}},[a("el-select",{attrs:{disabled:e.disabledAll,clearable:!1,size:"small",placeholder:"请选择通道"},model:{value:e.ruleName.channelNo,callback:function(t){e.$set(e.ruleName,"channelNo",t)},expression:"ruleName.channelNo"}},e._l(e.channelList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用:"}},[a("el-select",{attrs:{disabled:e.justLook,clearable:!1,size:"small",placeholder:"是否启用"},model:{value:e.ruleName.enable,callback:function(t){e.$set(e.ruleName,"enable",t)},expression:"ruleName.enable"}},e._l(e.enableOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),a("draggable",e._b({attrs:{disabled:e.justLook},on:{end:e.dragEnd},model:{value:e.ruleNameObj,callback:function(t){e.ruleNameObj=t},expression:"ruleNameObj"}},"draggable",e.dragOptions,!1),[a("transition-group",{attrs:{type:"transition"}},e._l(e.ruleNameObj,(function(t,l){return a("div",{key:t.sort,staticClass:"oneChoose"},[a("p",[e._v(e._s(e.sortName[t.orderName])),t.enable?e._e():a("span",{staticClass:"noenable"},[e._v("(已停用)")])]),e._v(" "),a("div",{staticClass:"isenable"},[a("el-select",{attrs:{disabled:e.disabledAll,clearable:!1,size:"mini",placeholder:"是否启用"},model:{value:t.enable,callback:function(a){e.$set(t,"enable",a)},expression:"item.enable"}},e._l(e.enableList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-checkbox",{attrs:{disabled:e.disabledAll,indeterminate:t.indeterminate},on:{change:function(t){return e.handleCheckAllChange(t,l)}},model:{value:t.checkAll,callback:function(a){e.$set(t,"checkAll",a)},expression:"item.checkAll"}},[e._v("全选")]),e._v(" "),a("div",{staticClass:"groupWrap"},[a("el-checkbox-group",{attrs:{disabled:e.disabledAll},on:{change:function(t){return e.changeGroup(t,l)}},model:{value:t.choose,callback:function(a){e.$set(t,"choose",a)},expression:"item.choose"}},e._l(t.selectList,(function(t,l){return a("el-checkbox",{key:l,attrs:{label:t.key}},[e._v("\n                    "+e._s(t.value)+"\n                  ")])})),1)],1)],1)})),0)],1)],1),e._v(" "),e.disabledAll?e._e():a("p",{staticClass:"tipword"},[e._v("提示:可使用鼠标拖拽排序")]),e._v(" "),e.justLook?e._e():a("div",{staticClass:"btn block"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitDicForm}},[e._v(e._s(e.ruleName.id?"编辑":"新增"))]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.closeCallback}},[e._v("取消")])],1)])}),[],!1,null,"1b725b77",null);t.default=h.exports},PorQ:function(e,t,a){},tbwQ:function(e,t,a){}}]);