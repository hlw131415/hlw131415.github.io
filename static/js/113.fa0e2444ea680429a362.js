(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{M1Gb:function(e,t,a){},YnbB:function(e,t,a){"use strict";a.r(t);var i={name:"editAuthConfig",props:{parentId:"",dialogVisible:{default:!1,type:Boolean},editObj:{type:Object,default:function(){return{}}}},data:function(){return{visible:this.dialogVisible,allInterface:[],oneData:[],treeData:[],show3:!1,expand:[],checked:[],defaultProps:{children:"children",label:"nameAndPath"},showNow:"",selectedNow:[],checkedList:[],bageList:[]}},mounted:function(){this.getInterFace()},methods:{changeCheck:function(e,t,a){var i=this;if(console.log(a),t){var n=!1;this.selectedNow.forEach((function(t,a){t.id===e.id&&(n=!0)})),n||(this.selectedNow.push(e),this.oparateData())}else this.selectedNow.forEach((function(t,a){e.id===t.id&&(i.selectedNow.splice(a,1),i.oparateData())}))},changeBadge:function(e,t){var a=this;this.bageList.forEach((function(i,n){console.log(t.name),t.name===i.name&&(e?a.$set(a.bageList[n],"badgeNum",a.bageList[n].badgeNum+1):a.$set(a.bageList[n],"badgeNum",a.bageList[n].badgeNum-1))}))},showOne:function(e){var t=this;this.showNow=e,this.show3=!0;var a=this.allInterface[e],i=[];a.forEach((function(e,a){t.selectedNow.forEach((function(t,a){e.id===t.operationId&&i.push(e.id)}))})),this.checkedList=i,console.log(i)},submitConfig:function(){var e=this;this.selectedNow.forEach((function(t,a){e.selectedNow[a].authId=e.editObj.guid,t.name&&(e.selectedNow[a].operationName=t.name),t.id&&(e.selectedNow[a].operationId=t.id)})),console.log(this.selectedNow),this.$request.operatorConfig(this.selectedNow).then((function(t){e.$message({type:"success",message:t.data}),e.closeCallback()}))},getOwnData:function(){var e=this;this.$request.getConfigList({authId:this.editObj.guid}).then((function(t){var a=t.data;a.forEach((function(e,t){a[t].name=e.operationName,a[t].id=e.operationId}));var i=[];a.forEach((function(e,t){var a=!0;i.forEach((function(t,i){e.id===t.id&&(a=!1)})),a&&i.push(e)})),e.selectedNow=i,e.bageList=[],e.oparateData()}))},oparateData:function(e){var t=this,a=[],i=function(e){var i=t.allInterface[e],n=0;i.forEach((function(e,a){t.selectedNow.forEach((function(t,a){e.id===t.id&&n++}))})),a.push({name:e,badgeNum:n})};for(var n in this.allInterface)i(n);this.bageList=a},getInterFace:function(){var e=this;this.$request.getAllInterface({guid:this.editObj.guid}).then((function(t){var a=t.data;for(var i in a){console.log(i);var n=a[i];n.length&&n.forEach((function(e){console.log(e),e.nameAndPath=e.name+" "+e.path}))}e.allInterface=a,e.getOwnData()}))},closeCallback:function(){this.$emit("closeDialog")}}},n=(a("wLng"),a("KHd+")),o=Object(n.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticStyle:{"text-indent":"0"},attrs:{title:"编辑"+e.editObj.authName+"功能模块配置",width:"700px",visible:e.visible,"destroy-on-close":""},on:{"update:visible":function(t){e.visible=t},close:e.closeCallback}},[a("div",e._l(e.bageList,(function(t,i){return a("el-badge",{key:i,staticClass:"oneTag",attrs:{hidden:t.badgeNum<1,value:t.badgeNum,type:"primary"}},[a("el-tag",{attrs:{type:t.name===e.showNow?"warning":"success"},on:{click:function(a){return e.showOne(t.name)}}},[e._v(e._s(t.name))])],1)})),1),e._v(" "),a("transition",{attrs:{name:"fade",mode:"out-in",duration:"300"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.show3,expression:"show3"}],staticClass:"transition-box"},[a("div",{staticClass:"showSelect"},e._l(e.allInterface,(function(t,i){return a("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.showNow===i,expression:"showNow === i"}],key:i,attrs:{"default-expand-all":"",size:"medium",data:t,"show-checkbox":"","node-key":"id","default-checked-keys":e.checkedList,props:e.defaultProps},on:{"check-change":e.changeCheck}})})),1)])]),e._v(" "),a("div",{staticClass:"btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitConfig}},[e._v(" 提交")])],1)],1)}),[],!1,null,"8a68e82a",null);t.default=o.exports},wLng:function(e,t,a){"use strict";a("M1Gb")}}]);