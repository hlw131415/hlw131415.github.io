(window.webpackJsonp=window.webpackJsonp||[]).push([[30,118],{"+O9i":function(e,t,a){},BfJG:function(e,t,a){},RQ2Q:function(e,t,a){"use strict";a("inZ3")},XOCO:function(e,t,a){"use strict";a.r(t);var n=a("mx9K"),i=a("rbZh"),l={name:"roleConfig",mixins:[a("uf7H").g],data:function(){return{input1:"",tableData:[],dialogPassVisible:!1,pageSize:20,pageNow:1,addRoleForm:{},pages:1,treeDisabled:!0,totalNum:1,justLook:!1,addDisabled:!0,addProp:{},isNewAdd:!1,treeData:[],rawNow:{}}},mounted:function(){this.getTableData()},methods:{addSuccess:function(){this.getTableData()},updateSuccess:function(e){var t=this;this.tableData.forEach((function(a,n){a.guid===e.guid&&t.$set(t.tableData,n,e)}))},deleteOne:function(e){var t=this;this.$confirm("确定删除角色"+e.roleName+"？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消",center:!0}).then((function(){t.$request.deleteOneRole({guid:e.guid}).then((function(a){t.$message({message:"删除成功!",type:"success"});var n=[];t.tableData.forEach((function(t,a){t!==e&&n.push(t)})),t.tableData=n}))})).catch((function(e){}))},filterTag:function(e,t){return t.enable===e},clearUp:function(){this.input1="",this.getTableData()},searchAction:function(e){console.log(e),this.input1=e,this.pageNow=1,this.getTableData()},handleCurrentChange:function(){this.getTableData()},handleClickShow2:function(e){this.addRoleForm=e,this.justLook=!0,this.dialogPassVisible=!0},handleClickShow:function(e){this.addRoleForm=this.copySimple(e),this.justLook=!1,this.dialogPassVisible=!0},handleClickEdit:function(e){this.isNewAdd=!1,this.addProp=e,this.addDisabled=!1,this.dialogPassVisible=!0},handleClickDelete:function(e){var t=this;this.$confirm("确定删除？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.$request.deleteOneRole({guid:e.guid}).then((function(a){t.$message({message:"删除成功!",type:"success"});var n=[];t.tableData.forEach((function(t,a){t!==e&&n.push(t)})),t.tableData=n}))})).catch((function(e){}))},getTableData:function(){var e=this;this.$request.getRoleList({data:{roleName:this.input1},current:this.pageNow,size:this.pageSize}).then((function(t){e.tableData=t.data.data,e.totalNum=t.data.total,e.pages=t.data.pages}))},addNewRole:function(){this.addRoleForm={enable:!0},this.isNewAdd=!0,this.justLook=!1,this.dialogPassVisible=!0},editCallback:function(){this.dialogPassVisible=!1}},components:{AddRole:n.default,SearchTab:i.a}},s=(a("sPtB"),a("KHd+")),r=Object(s.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("SearchTab",{attrs:{searchName:"角色名称",whatName:"角色",input1:e.input1,placeholder:"输入角色名称查询",hiddenAdd:!e.$showColumn("addRole")},on:{searchAction:e.searchAction,clearUp:e.clearUp,addNewRole:e.addNewRole}}),e._v(" "),a("div",{},[a("div",{staticClass:"dataTable"},[a("el-table",{ref:"tableAutoMaxHeight",attrs:{data:e.tableData,"max-height":e.tableMaxHeight,size:"small"}},[a("el-table-column",{attrs:{prop:"roleName",label:"角色名称",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"enable",filters:[{text:"已开",value:!0},{text:"关闭",value:!1}],"filter-method":e.filterTag,"filter-placement":"bottom-end",label:"是否启用",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Tag",{attrs:{type:t.row.enable?"success":"danger"}},[e._v(e._s(t.row.enable?"已启用":"未启用"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",sortable:""}}),e._v(" "),e.$showColumn(["lookRole","editRole","deleteRole"])?a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Icon",{directives:[{name:"stat",rawName:"v-stat",value:"lookRole",expression:"'lookRole'"}],attrs:{icon:"icon-chakan1",tip:"查看"},nativeOn:{click:function(a){return e.handleClickShow2(t.row)}}}),e._v(" "),3==t.row.roleLeave?a("Icon",{directives:[{name:"stat",rawName:"v-stat",value:"editRole",expression:"'editRole'"}],attrs:{icon:"icon-bianji",tip:"编辑"},nativeOn:{click:function(a){return e.handleClickShow(t.row)}}}):e._e(),e._v(" "),3==t.row.roleLeave?a("Icon",{directives:[{name:"stat",rawName:"v-stat",value:"deleteRole",expression:"'deleteRole'"}],attrs:{icon:"icon-shanchu",tip:"删除"},nativeOn:{click:function(a){return e.deleteOne(t.row)}}}):e._e()]}}],null,!1,4146171825)}):e._e()],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pageNow,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalNum},on:{"size-change":e.$handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.pageNow=t},"update:current-page":function(t){e.pageNow=t}}})],1)]),e._v(" "),e.dialogPassVisible?a("AddRole",{attrs:{isNewAdd:e.isNewAdd,isDisabled:e.addDisabled,justLook:e.justLook,treeData2:e.treeData,addRoleForm:e.addRoleForm,areaTree:e.mixinAreaTree,dialogVisible:e.dialogPassVisible},on:{addSuccess:e.addSuccess,updateSuccess:e.updateSuccess,editCallback:e.editCallback}}):e._e()],1)}),[],!1,null,"7bbaed23",null);t.default=r.exports},inZ3:function(e,t,a){},mx9K:function(e,t,a){"use strict";a.r(t);var n={name:"addRole",props:{treeDisabled:{type:Boolean,default:!0},justLook:{type:Boolean,default:!0},areaTree:{type:Array,default:function(){return[]}},treeData2:{type:Array,default:function(){return[]}},isNewAdd:{type:Boolean,default:!1},dialogVisible:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},addRoleForm:{type:Object,default:function(){}}},data:function(){return{rules:{enable:[{required:!0,validator:function(e,t,a){console.log(t),!1===t||t?a():a(new Error("请选择是否启用"))},trigger:"blur"}],roleName:this.$rules.validate("请输入角色名称",10),remark:this.$rules.validate("",50,!1)},sites:[],options:[{label:"启用",value:!0},{label:"禁用",value:!1}],treeData:[],defaultProps:{children:"children",label:"authName"},visible:this.dialogVisible,expand:[],checked:[],currentKeys:[],formLabelWidth:"94px",roleOptions:[],checkList:[]}},mounted:function(){this.getList()},methods:{getPageIdArr:function(e){var t=[];return this.treeData.forEach((function(a,n){a.guid===e&&a.children&&a.children.length&&a.children.forEach((function(e,a){t.push(e.guid)}))})),t},changeCheck:function(e,t){if(t.checkedKeys.indexOf(e.guid)>=0)this.uniteChildSame(e,!0),2===e.authType&&this.$refs.dataTree.setChecked(e.parentId,!0);else{if(2===e.authType){var a=this.getPageIdArr(e.parentId),n=!0;a.forEach((function(e,a){t.checkedKeys.indexOf(e)>=0&&(n=!1)})),n&&this.$refs.dataTree.setChecked(e.parentId,!1)}e.children&&e.children.length&&this.uniteChildSame(e,!1)}},uniteChildSame:function(e,t){if(!e.disabled)if(this.$refs.dataTree.setChecked(e.guid,t),e.children&&e.children.length)for(var a=0;a<e.children.length;a++)e.children[a].disabled||this.uniteChildSame(e.children[a],t);else e.parentId&&this.$refs.dataTree.setChecked(e.parentId,t)},selectedParent:function(e){var t=this.$refs.dataTree.getNode(e);void 0!==t.parent.key&&(this.$refs.tree.setChecked(t.parent,!0),this.selectedParent(t.parent))},uncheckChildren2:function(e){var t=this;return function e(a){a.forEach((function(a,n){if(a.isCheck=!0,t.checked.indexOf(a.guid)<0){var i=t.copySimple(t.checked);i.push(a.guid),t.checked=i}console.log(a.guid),a.children&&a.children.length&&e(a.children)}))}(e),e},uncheckChildren:function(e){var t=this;return function e(a){a.forEach((function(a,n){a.isCheck=!1,t.checked.indexOf(a.guid)>=0&&t.checked.splice(t.checked.indexOf(a.guid),1),a.children&&a.children.length&&e(a.children)}))}(e),e},changeSite:function(){this.addRoleForm.portOneLevelId=this.$getPortId(1,this.sites,this.areaTree),this.addRoleForm.portTwoLevelId=this.$getPortId(2,this.sites,this.areaTree)},getList:function(){var e=this,t={};this.addRoleForm.guid&&(t.roleId=this.addRoleForm.guid),this.$request.getAuthTree(t).then((function(t){e.expand=[],e.checked=[],console.log(t),e.getChecked(t.data,null)}))},getChecked:function(e,t){var a=this,n=this.copySimple(e),i=[],l=[];!function e(t,n){t.forEach((function(t,s){a.justLook&&(t.disabled="disabled"),t.isChange||(t.disabled="disabled"),1===t.authType&&t.isCheck&&i.indexOf(t.guid)<0&&i.push(t.guid),3===t.authType&&t.isCheck&&(i.indexOf(t.guid)<0&&i.push(t.guid),n&&l.indexOf(n.guid)<0&&l.push(n.guid)),2===t.authType&&t.isCheck&&(i.indexOf(t.guid)<0&&i.push(t.guid),l.indexOf(t.guid)<0&&l.push(t.guid)),t.children&&t.children.length&&e(t.children,t)}))}(n,t),this.$refs.dataTree.setCheckedKeys(i),this.expand=l,this.treeData=n},submitRole:function(){var e=this;if(this.checkList=[],this.$refs.dataTree.getCheckedNodes().forEach((function(t,a){e.checkList.indexOf(t.guid)<0&&e.checkList.push(t.guid)})),this.checkList.length<1)return this.$message({message:"请分配角色功能权限",type:"warning"}),!1;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var a={roleName:e.addRoleForm.roleName,enable:e.addRoleForm.enable,remark:e.addRoleForm.remark,roleLeave:e.addRoleForm.roleLeave,authList:e.checkList,guid:e.addRoleForm.guid};e.addRoleForm.guid?e.$request.editRole(a).then((function(t){e.$emit("updateSuccess",a),e.$message({message:"编辑成功!",type:"success"}),e.closeCallback()})):e.$request.addRole(a).then((function(t){e.$emit("addSuccess"),e.$message({message:"添加成功!",type:"success"}),e.closeCallback()}))}))},isAllChecked:function(e){var t=0,a=!1;return e.forEach((function(e,a){e.isCheck&&t++})),t===e.length&&(a=!0),a},closeCallback:function(){this.$emit("editCallback")},getCheckedNodes:function(){}}},i=(a("y55E"),a("KHd+")),l=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"close-on-click-modal":e.justLook,width:"700px",visible:e.visible,"destroy-on-close":""},on:{"update:visible":function(t){e.visible=t},close:e.closeCallback}},[a("div",{staticClass:"dialogTitleDiy"},[e._v(e._s(!e.justLook&&e.addRoleForm.guid?"编辑角色":e.justLook?"查看角色":"添加角色"))]),e._v(" "),a("div",{staticClass:"addRoleBoxWrap"},[a("div",{staticClass:"addRoleBox"},[a("el-form",{ref:"ruleForm",attrs:{model:e.addRoleForm,rules:e.rules,disabled:e.justLook,"hide-required-asterisk":e.justLook}},[a("el-form-item",{attrs:{label:"角色名称:","label-width":e.formLabelWidth,prop:"roleName"}},[a("el-input",{attrs:{placeholder:"请输入角色名称",size:"small"},model:{value:e.addRoleForm.roleName,callback:function(t){e.$set(e.addRoleForm,"roleName",t)},expression:"addRoleForm.roleName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用:","label-width":e.formLabelWidth,prop:"enable"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:!1,placeholder:"是否启用"},model:{value:e.addRoleForm.enable,callback:function(t){e.$set(e.addRoleForm,"enable",t)},expression:"addRoleForm.enable"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注:","label-width":e.formLabelWidth,prop:"remark"}},[a("el-input",{attrs:{placeholder:"请输入备注",size:"small"},model:{value:e.addRoleForm.remark,callback:function(t){e.$set(e.addRoleForm,"remark",t)},expression:"addRoleForm.remark"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"datatable2"},[a("p",{staticClass:"rrrl"},[e._v("分配权限:")]),e._v(" "),a("div",{staticClass:"dataTable"},[a("el-tree",{ref:"dataTree",attrs:{size:"medium",data:e.treeData,"check-strictly":"",disabled:e.justLook,"show-checkbox":"","node-key":"guid","default-expanded-keys":e.expand,props:e.defaultProps},on:{check:e.changeCheck}})],1)])]),e._v(" "),e.justLook?e._e():a("div",{staticClass:"btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitRole}},[e._v(e._s(e.addRoleForm.guid?"编辑":"新增"))]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.closeCallback}},[e._v("取消")])],1)])}),[],!1,null,"bddc3c72",null);t.default=l.exports},rbZh:function(e,t,a){"use strict";var n={name:"searchTab",data:function(){return{input2:""}},props:{labelWidth:{type:String,default:"80px"},firstSearchName:{type:String,default:""},placeholder:{type:String,default:"支持模糊查询"},hiddenAdd:{type:Boolean,default:function(){return!1}},searchName:{type:String,default:"名称"},whatName:{type:String,default:"角色"}},methods:{clearUp:function(){this.input2="",this.$emit("clearUp")},searchAction:function(){this.$emit("searchAction",this.input2)},addNewRole:function(){this.$emit("addNewRole")}}},i=(a("RQ2Q"),a("KHd+")),l=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"searchBox"},[a("div",[a("div",{staticClass:"inputWrap"},[a("el-form",{attrs:{"label-width":e.labelWidth,inline:""}},[a("el-form-item",{attrs:{label:e.searchName?e.searchName+":":""}},[a("el-input",{staticStyle:{display:"inline-block",width:"246px",margin:"0 24px 0 4px"},attrs:{placeholder:e.placeholder,size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchAction.apply(null,arguments)}},model:{value:e.input2,callback:function(t){e.input2=t},expression:"input2"}})],1),e._v(" "),a("el-form-item",{staticClass:"hideBorder"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchAction}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"info",icon:"el-icon-delete"},on:{click:e.clearUp}},[e._v("清空")]),e._v(" "),e.hiddenAdd?e._e():a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addNewRole}},[e._v("添加")])],1)],1),e._v(" "),e._t("totalNum")],2)])])])}),[],!1,null,"7ff3c41f",null);t.a=l.exports},sPtB:function(e,t,a){"use strict";a("BfJG")},uf7H:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return s})),a.d(t,"i",(function(){return o})),a.d(t,"h",(function(){return d})),a.d(t,"g",(function(){return c})),a.d(t,"l",(function(){return h})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return f})),a.d(t,"k",(function(){return m})),a.d(t,"j",(function(){return p})),a.d(t,"e",(function(){return r}));var n=a("KEZ+"),i={data:function(){return{mixIncarOption:[{label:"汽车",value:1},{label:"货车",value:2}]}}},l={data:function(){return{mixIncarOption2:[]}},mounted:function(){this.mixinGetCarTypeList()},methods:{mixinGetCarTypeList:function(){var e=this;n.a.state.carTypeList&&n.a.state.carTypeList.length?this.mixIncarOption2=n.a.state.carTypeList:this.$request.getCarTypeList().then((function(t){var a=e.$objToArr(t.data);e.mixIncarOption2=a,n.a.state.carTypeList=a}))}}},s={data:function(){return{mixinCarIoType:[{label:"进口",value:"I",text:"进口"},{label:"出口",value:"O",text:"出口"}]}}},r={data:function(){return{mixinEntryExit:[{label:"入境",value:"I",text:"入境"},{label:"出境",value:"O",text:"出境"}]}}},o={data:function(){return{mixinChannelType:[]}},mounted:function(){this.mixinGetChannelType()},methods:{mixinGetChannelType:function(){var e=this;n.a.state.channelTypes&&n.a.state.channelTypes.length?this.mixinChannelType=n.a.state.channelTypes:this.$request.getChannelType().then((function(t){var a=e.$objToArr(t.data);e.mixinChannelType=a,n.a.state.channelTypes=a}))}}},d={data:function(){return{mixinChannelTag:[]}},mounted:function(){this.mixinGetChannelTag()},methods:{mixinGetChannelTag:function(){var e=this;n.a.state.channelTags&&n.a.state.channelTags.length?this.mixinChannelTag=n.a.state.channelTags:this.$request.getChannelTags().then((function(t){var a=e.$objToArr(t.data);e.mixinChannelTag=a,n.a.state.channelTags=a}))}}},c={data:function(){return{mixinAreaTree:[]}},mounted:function(){this.mixinGetAreaTree()},methods:{mixinGetAreaTree:function(){var e=this;this.$request.getApartmentTree().then((function(t){var a=t.data;e.$changeTree(a),e.mixinAreaTree=a}))}}},u={data:function(){return{mixinALlChannel:[],mixinALlChannelGuid:[]}},mounted:function(){this.mixinGetAllChannel()},methods:{mixinGetAllChannel:function(){var e=this;this.$request.getAllChannelData().then((function(t){var a=t.data,n=[],i=[];a.forEach((function(e,t){n.push({label:e.channelName,value:e.channelNo,text:e.channelName}),i.push({label:e.channelName,value:e.guid,text:e.channelName})})),e.mixinALlChannel=n,e.mixinALlChannelGuid=i}))}}},h={data:function(){return{mixinUserInOutType:[],mixinChannelInOutType:[]}},mounted:function(){this.mixinGetUserInOutType()},methods:{mixinGetUserInOutType:function(){var e=this;n.a.state.channelInOutType&&n.a.state.channelInOutType.length&&(this.mixinChannelInOutType=n.a.state.channelInOutType),n.a.state.userInOutType&&n.a.state.userInOutType.length?this.mixinUserInOutType=n.a.state.userInOutType:this.$request.getUserInOutType().then((function(t){var a=e.$objToArr(t.data);e.mixinUserInOutType=a,n.a.state.userInOutType=a;var i=[];a.forEach((function(e,t){""!==e.value&&i.push(e)})),e.mixinChannelInOutType=i,n.a.state.channelInOutType=i}))}}},f={data:function(){return{mixinDriveType:[{label:"正常入境",value:"0",text:"正常入境"},{label:"退出通道",value:"1",text:"退出通道"},{label:"驶入退车",value:"2",text:"驶入退车"}]}}},p={data:function(){return{mixinPictureBase:""}},mounted:function(){var e=this;console.log(n.a.state.mixinPictureBase),n.a.state.mixinPictureBase&&n.a.state.mixinPictureBase.length?this.mixinPictureBase=n.a.state.mixinPictureBase:this.$request.getPictureInfoBase().then((function(t){console.log(t),t.data&&(e.mixinPictureBase="http://"+t.data+"?id=",n.a.state.mixinPictureBase="http://"+t.data+"?id=")}))}},m={data:function(){return{mixinResult:[{label:"放行",value:"YP",text:"放行"},{label:"不放行",value:"NP",text:"不放行"},{label:"查验",value:"CP",text:"查验"},{label:"退车",value:"EP",text:"退车"},{label:"未处理",value:"NN",text:"未处理"},{label:"应急放行",value:"TP",text:"应急放行"},{label:"人工拦截",value:"MN",text:"人工拦截"},{label:"放行",value:"QYP",text:"放行"},{label:"不放行",value:"QNP",text:"不放行"},{label:"查验",value:"QCP",text:"查验"},{label:"退车",value:"QEP",text:"退车"}]}}}},y55E:function(e,t,a){"use strict";a("+O9i")}}]);