(window.webpackJsonp=window.webpackJsonp||[]).push([[44,130],{Q8zG:function(t,e,a){},RD0o:function(t,e,a){"use strict";a.r(e);var l=a("gDS+"),o=a.n(l),s=(a("gJae"),a("lT11")),n={name:"alarmHistory",data:function(){return{headerHeight:"66px",showTable:!0,statuList:[{label:"已发布",value:"Y"},{label:"暂存",value:"N"}],options:[{label:"大门",value:"A"},{label:"月台区域",value:"M"}],tableData:[],activeName:"",formData:{title:"",site:"",content:""},rules:{title:this.$rules.validate("请输入消息标题"),site:this.$rules.validate("请选择消息发布LED")},editorOption:{placeholder:"请输入信息"}}},mounted:function(){localStorage.getItem("pushInfo")||localStorage.setItem("pushInfo",o()([{content:'<h2 class="ql-align-center"><span style="color: rgb(230, 0, 0);">注意事项</span>\n      </h2><p class="ql-align-center"><br></p><p class="ql-align-center">由于疫情影响，请使用微信小程序预约后排队入场</p>\n      <p class="ql-align-center"><br></p><p class="ql-align-center">谢谢合作!</p><p><br></p>',site:["M"],createTime:1644305971549,creater:"admin",guid:1234,status:"N",title:"入场口通知显示屏"}])),this.tableData=JSON.parse(localStorage.getItem("pushInfo"))},methods:{handleEdit:function(t){this.formData=this.copySimple(t),this.showTable=!1},toggleShow:function(){var t=this;this.showTable=!this.showTable,this.formData={},this.$nextTick((function(){t.showTable||(t.headerHeight=document.getElementsByClassName("ql-toolbar")[0].offsetHeight+"px")}))},getName:function(t){var e="";return this.options.filter((function(e,a){return t&&t.indexOf(e.value)>=0})).forEach((function(t){e+=e?"  , "+t.label:t.label})),e+" "},showContent:function(){},submit:function(t){var e=this;this.$refs.ruleForm.validate((function(a){if(a)if(e.formData.content)if(e.$message({message:"提交成功!",type:"success"}),e.formData.status=t,e.formData.guid)e.tableData.forEach((function(t,a){t.guid===e.formData.guid&&e.$set(e.tableData,a,e.formData)})),e.toggleShow();else{if(e.formData.guid=(new Date).getTime(),e.formData.createTime=(new Date).getTime(),e.formData.creater="admin",localStorage.getItem("pushInfo")){var l=JSON.parse(localStorage.getItem("pushInfo"));l.push(e.formData),localStorage.setItem("pushInfo",o()(l))}else localStorage.setItem("pushInfo",o()([e.formData]));e.tableData.push(e.formData),e.toggleShow()}else e.$message({message:"请先填写信息内容!",type:"error"})}))}},components:{Search:a("Woc8").default,quillEditor:s.quillEditor}},i=(a("pbF/"),a("o/9Z"),a("KHd+")),r=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cWrap"},[t.showTable?a("div",{staticClass:"infoTableWrap"},[a("Search",{on:{addNewRoom:t.toggleShow}}),t._v(" "),a("el-table",{ref:"tableAutoMaxHeight",attrs:{data:t.tableData,"max-height":t.tableMaxHeight}},[a("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":"",prop:"title",label:"标题"}}),t._v(" "),a("el-table-column",{attrs:{prop:"content",label:"内容"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"ql-editor",domProps:{innerHTML:t._s(e.row.content)}})]}}],null,!1,2414860620)}),t._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("Tag",{attrs:{type:"Y"===e.row.status?"success":"info"}},[t._v(t._s(t.$getName(e.row.status,t.statuList)))])]}}],null,!1,4135808413)}),t._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"site",label:"展示LED"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(t.getName(e.row.site))+"\n          ")]}}],null,!1,491186982)}),t._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"creater",label:"创建人"}}),t._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"createTime",label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(t.$getLocalTime(e.row.createTime))+"\n          ")]}}],null,!1,124679495)}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("Icon",{directives:[{name:"stat",rawName:"v-stat",value:"edit",expression:"'edit'"}],attrs:{icon:"icon-bianji",tip:"编辑"},nativeOn:{click:function(a){return t.handleEdit(e.row)}}}),t._v(" "),a("Icon",{directives:[{name:"stat",rawName:"v-stat",value:"delete",expression:"'delete'"}],attrs:{icon:"icon-shanchu",tip:"删除"},nativeOn:{click:function(a){return t.handleDelete(e.row)}}})]}}],null,!1,720941915)})],1)],1):a("div",{staticClass:"editer searchBox"},[a("el-form",{ref:"ruleForm",staticClass:"form",attrs:{"label-width":"140px",rules:t.rules,model:t.formData,inline:""}},[a("el-form-item",{attrs:{label:"消息标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入消息标题"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"选择消息发布LED",prop:"site"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择消息发布LED"},model:{value:t.formData.site,callback:function(e){t.$set(t.formData,"site",e)},expression:"formData.site"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.toggleShow}},[t._v("返回")])],1),t._v(" "),a("div",{staticClass:"editerWrap"},[a("quillEditor",{ref:"myQuillEditor",attrs:{options:t.editorOption},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}}),t._v(" "),a("div",{staticClass:"preview"},[a("div",{staticClass:"head",style:{height:t.headerHeight,lineHeight:t.headerHeight}},[t._v("\n                  效果预览\n              ")]),t._v(" "),a("div",{staticClass:"content ql-editor",domProps:{innerHTML:t._s(t.formData.content)}}),t._v(" "),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submit("Y")}}},[t._v("发布")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submit("N")}}},[t._v("暂存")])],1)])],1)],1)])}),[],!1,null,"59a3fa97",null);e.default=r.exports},Woc8:function(t,e,a){"use strict";a.r(e);var l={name:"search",data:function(){return{searchPoint:{}}},props:{},methods:{clearUp:function(){this.searchPoint={},this.$emit("clearUp")},searchAction:function(){this.$emit("searchAction",this.searchPoint)},addNewRole:function(){this.$emit("addNewRoom")}}},o=a("KHd+"),s=Object(o.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"searchBox2 searchBox"},[a("el-form",{attrs:{inline:"",model:t.searchPoint,"label-width":"56px"}},[a("el-form-item",{attrs:{label:"标题:"}},[a("el-input",{model:{value:t.searchPoint.title,callback:function(e){t.$set(t.searchPoint,"title",e)},expression:"searchPoint.title"}})],1),t._v(" "),a("el-form-item",{staticClass:"hideBorder"},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:t.searchAction}},[t._v("搜索")]),t._v(" "),a("FormButton",{attrs:{type:"clear"},on:{click:t.clearUp}},[t._v("清空")]),t._v(" "),a("FormButton",{attrs:{type:"add"},on:{click:t.addNewRole}},[t._v("添加消息")])],1)],1)],1)])}),[],!1,null,"9db3e500",null);e.default=s.exports},"o/9Z":function(t,e,a){"use strict";a("Q8zG")},"pbF/":function(t,e,a){"use strict";a("rjYJ")},rjYJ:function(t,e,a){}}]);