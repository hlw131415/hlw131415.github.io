(window.webpackJsonp=window.webpackJsonp||[]).push([[36,112,113],{"/Oi6":function(e,t,i){},"0dLE":function(e,t,i){},"Jku/":function(e,t,i){"use strict";i.r(t);var a={name:"config",props:{showNow:{type:Array,default:function(){return[]}},configRight:{type:Boolean,default:!1}},data:function(){return{parentId:1,activeNames:[],dialogVisible:!1,editObj:{}}},computed:{},mounted:function(){console.log(this.showNow)},methods:{deleOne:function(e){var t=this;this.$confirm("确定删除？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){var i=[];i.push(e.guid),t.$request.deleConfig(i).then((function(i){t.$message({message:"删除成功!",type:"success"});var a=[];t.showNow.forEach((function(t,i){t!==e&&a.push(t)})),t.$emit("changeShowNow",a)}))})).catch((function(e){}))},editOne:function(e){this.$emit("openEdit",e)}}},n=(i("qHyC"),i("KHd+")),o=Object(n.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"editConfig"},[i("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.showNow,(function(t,a){return i("el-collapse-item",{key:a,attrs:{title:t.authName,name:t.guid}},[i("div",{staticClass:"buttons"},[e.configRight?i("div",{staticClass:"buttons"},[i("el-tag",{attrs:{type:"primary"},on:{click:function(i){return e.editOne(t)}}},[e._v("编辑功能权限")])],1):i("div",{staticClass:"buttons"},[i("el-tag",{attrs:{type:"primary"},on:{click:function(i){return e.editOne(t)}}},[e._v("编辑")]),e._v(" "),i("el-tag",{attrs:{type:"info"},on:{click:function(i){return e.deleOne(t)}}},[e._v("删除")])],1)]),e._v(" "),e._l(t.children,(function(t,a){return i("el-collapse-item",{key:a,attrs:{title:t.authName,name:t.guid}},[e.configRight?i("div",{staticClass:"buttons"},[i("el-tag",{attrs:{type:"primary"},on:{click:function(i){return e.editOne(t)}}},[e._v("编辑功能权限")])],1):i("div",{staticClass:"buttons"},[i("el-tag",{attrs:{type:"primary"},on:{click:function(i){return e.editOne(t)}}},[e._v("编辑")]),e._v(" "),i("el-tag",{attrs:{type:"info"},on:{click:function(i){return e.deleOne(t)}}},[e._v("删除")])],1)])}))],2)})),1)],1)}),[],!1,null,"30452534",null);t.default=o.exports},M1Gb:function(e,t,i){},UVKw:function(e,t,i){"use strict";i("0dLE")},YnbB:function(e,t,i){"use strict";i.r(t);var a={name:"editAuthConfig",props:{parentId:"",dialogVisible:{default:!1,type:Boolean},editObj:{type:Object,default:function(){return{}}}},data:function(){return{visible:this.dialogVisible,allInterface:[],oneData:[],treeData:[],show3:!1,expand:[],checked:[],defaultProps:{children:"children",label:"nameAndPath"},showNow:"",selectedNow:[],checkedList:[],bageList:[]}},mounted:function(){this.getInterFace()},methods:{changeCheck:function(e,t,i){var a=this;if(console.log(i),t){var n=!1;this.selectedNow.forEach((function(t,i){t.id===e.id&&(n=!0)})),n||(this.selectedNow.push(e),this.oparateData())}else this.selectedNow.forEach((function(t,i){e.id===t.id&&(a.selectedNow.splice(i,1),a.oparateData())}))},changeBadge:function(e,t){var i=this;this.bageList.forEach((function(a,n){console.log(t.name),t.name===a.name&&(e?i.$set(i.bageList[n],"badgeNum",i.bageList[n].badgeNum+1):i.$set(i.bageList[n],"badgeNum",i.bageList[n].badgeNum-1))}))},showOne:function(e){var t=this;this.showNow=e,this.show3=!0;var i=this.allInterface[e],a=[];i.forEach((function(e,i){t.selectedNow.forEach((function(t,i){e.id===t.operationId&&a.push(e.id)}))})),this.checkedList=a,console.log(a)},submitConfig:function(){var e=this;this.selectedNow.forEach((function(t,i){e.selectedNow[i].authId=e.editObj.guid,t.name&&(e.selectedNow[i].operationName=t.name),t.id&&(e.selectedNow[i].operationId=t.id)})),console.log(this.selectedNow),this.$request.operatorConfig(this.selectedNow).then((function(t){e.$message({type:"success",message:t.data}),e.closeCallback()}))},getOwnData:function(){var e=this;this.$request.getConfigList({authId:this.editObj.guid}).then((function(t){var i=t.data;i.forEach((function(e,t){i[t].name=e.operationName,i[t].id=e.operationId}));var a=[];i.forEach((function(e,t){var i=!0;a.forEach((function(t,a){e.id===t.id&&(i=!1)})),i&&a.push(e)})),e.selectedNow=a,e.bageList=[],e.oparateData()}))},oparateData:function(e){var t=this,i=[],a=function(e){var a=t.allInterface[e],n=0;a.forEach((function(e,i){t.selectedNow.forEach((function(t,i){e.id===t.id&&n++}))})),i.push({name:e,badgeNum:n})};for(var n in this.allInterface)a(n);this.bageList=i},getInterFace:function(){var e=this;this.$request.getAllInterface({guid:this.editObj.guid}).then((function(t){var i=t.data;for(var a in i){console.log(a);var n=i[a];n.length&&n.forEach((function(e){console.log(e),e.nameAndPath=e.name+" "+e.path}))}e.allInterface=i,e.getOwnData()}))},closeCallback:function(){this.$emit("closeDialog")}}},n=(i("wLng"),i("KHd+")),o=Object(n.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticStyle:{"text-indent":"0"},attrs:{title:"编辑"+e.editObj.authName+"功能模块配置",width:"700px",visible:e.visible,"destroy-on-close":""},on:{"update:visible":function(t){e.visible=t},close:e.closeCallback}},[i("div",e._l(e.bageList,(function(t,a){return i("el-badge",{key:a,staticClass:"oneTag",attrs:{hidden:t.badgeNum<1,value:t.badgeNum,type:"primary"}},[i("el-tag",{attrs:{type:t.name===e.showNow?"warning":"success"},on:{click:function(i){return e.showOne(t.name)}}},[e._v(e._s(t.name))])],1)})),1),e._v(" "),i("transition",{attrs:{name:"fade",mode:"out-in",duration:"300"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.show3,expression:"show3"}],staticClass:"transition-box"},[i("div",{staticClass:"showSelect"},e._l(e.allInterface,(function(t,a){return i("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.showNow===a,expression:"showNow === i"}],key:a,attrs:{"default-expand-all":"",size:"medium",data:t,"show-checkbox":"","node-key":"id","default-checked-keys":e.checkedList,props:e.defaultProps},on:{"check-change":e.changeCheck}})})),1)])]),e._v(" "),i("div",{staticClass:"btn"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitConfig}},[e._v(" 提交")])],1)],1)}),[],!1,null,"8a68e82a",null);t.default=o.exports},fgEo:function(e,t,i){"use strict";i.r(t);var a=i("GQeE"),n=i.n(a),o=i("YnbB"),s={name:"authConfig",data:function(){return{allFace:[],firstArr:[],showNow:[],isNewAdd:!0,allPage:[],dialogVisible:!1,editObj:{},parentId:1,arrTree:[]}},mounted:function(){this.getAllConfig()},methods:{changeNow:function(e){this.parentId=e.guid},changeShowNow:function(e){this.showNow=e},getAllConfig:function(){var e=this;this.$request.getAllConfig().then((function(t){e.allPage=t.data}))},addNew:function(e){if(e.parentId){var t=function t(i){var a=i.arr,n=i.value,o=i.item,s=[];return a.forEach((function(i){i.guid===n?(i.children.push(e),s.push(i)):i.children&&i.children.length>0?(i.children=t({arr:i.children,value:n,item:o}),s.push(i)):s.push(i)})),s}({arr:this.allPage,value:e.parentId,obj:e});console.log(t),this.allPage=t}else this.allPage.push(e)},changeData:function(e){for(var t=0;t<this.allPage.length;t++)if(e===this.allPage[t])if(this.allPage[t].children)this.allPage[t].children.push(e);else{var i=[];i.push(e),this.allPage[t].children=i}else this.allPage[t].children&&this.allPage[t].children.length&&this.changeData(this.allPage[t].children)},addConfig:function(){this.isNewAdd=!0,this.dialogVisible=!0},openEdit:function(e){console.log(e),this.isNewAdd=!1,this.editObj=e,this.dialogVisible=!0},closeDialog:function(){this.dialogVisible=!1},clickOne:function(e,t){this.showNow=this.allPage[e.index].children?this.allPage[e.index].children:[],this.parentId=this.allPage[e.index].guid},getAllInterface:function(){var e=this;this.$request.getAllInterface().then((function(t){e.allFace=t.data;var i=[];for(var a in t.data)a.notAllow||i.push(a);e.firstArr=i,e.showNow=e.allFace[i[0]]}))},getkey:function(e){return console.log(e),n()(e)[0]}},components:{Config:i("Jku/").default,EditAuthConfig:o.default}},l=(i("UVKw"),i("KHd+")),c=Object(l.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{},[i("div",{staticClass:"dataTable"},[i("el-table",{ref:"tableAutoMaxHeight",staticStyle:{"margin-bottom":"20px"},attrs:{stripe:"","highlight-current-row":"",size:"small",data:e.allPage,"row-key":"guid",border:"","default-expand-all":"","max-height":e.tableMaxHeight,"tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"current-change":e.changeNow}},[i("el-table-column",{attrs:{prop:"authName",label:"名称",align:"left",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"isVisible",label:"是否可见",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("Tag",{attrs:{type:t.row.isVisible?"success":"danger"}},[e._v(e._s(t.row.isVisible?"可见":"不可见"))])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"authType",sortable:"",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(1===t.row.authType?"菜单":2===t.row.authType?"页面":"按钮")+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"authPath",sortable:"",label:"地址"}}),e._v(" "),e.$showColumn("diyConfig")?i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return 1!==t.row.authType?[i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(i){return e.openEdit(t.row)}}},[e._v("配置权限")])],1)]:void 0}}],null,!0)}):e._e()],1)],1)]),e._v(" "),e.dialogVisible?i("EditAuthConfig",{attrs:{parentId:e.parentId,isNewAdd:e.isNewAdd,editObj:e.editObj,dialogVisible:e.dialogVisible},on:{addNew:e.addNew,closeDialog:e.closeDialog}}):e._e()],1)}),[],!1,null,"fc3c7a52",null);t.default=c.exports},qHyC:function(e,t,i){"use strict";i("/Oi6")},wLng:function(e,t,i){"use strict";i("M1Gb")}}]);