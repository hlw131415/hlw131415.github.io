(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{"4oD0":function(e,t,a){},BLAu:function(e,t,a){"use strict";var l={name:"searchTab",data:function(){return{input2:"",pickTime:"",channelNo:"",select2:""}},props:{hideSearchInput:{type:Boolean,default:function(){return!1}},hideSelect4:{type:Boolean,default:function(){return!1}},hideSelect2:{type:Boolean,default:function(){return!1}},select2Name:{type:String,default:"通道"},selectName:{type:String,default:"通道"},optionName:{type:String,default:"请选择"},placeholder:{type:String,default:"支持模糊查询"},selectList:{type:Array,default:function(){return[]}},selectList2:{type:Array,default:function(){return[]}},hiddenAdd:{type:Boolean,default:function(){return!1}},searchName:{type:String,default:"名称"},whatName:{type:String,default:"角色"}},methods:{clearUp:function(){this.input2="",this.pickTime="",this.searchUser="",this.channelNo="",this.select2="",this.$emit("clearUp")},searchAction:function(){var e={input2:this.input2,channelNo:this.channelNo,select2:this.select2};this.pickTime?e.pickTime=this.pickTime:e.pickTime=["",""],this.$emit("searchAction",e)},addNewRole:function(){this.$emit("addNewRole")}}},n=(a("uZ5c"),a("KHd+")),i=Object(n.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"messageSearch searchBox"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,"label-width":"90px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchAction.apply(null,arguments)}}},[e.hideSearchInput?a("el-form-item",{attrs:{label:e.placeholder}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.input2,callback:function(t){e.input2=t},expression:"input2"}})],1):e._e(),e._v(" "),e.hideSelect2?a("el-form-item",{attrs:{label:e.select2Name+":"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.select2,callback:function(t){e.select2=t},expression:"select2"}},e._l(e.selectList2,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:e.selectName+":"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.channelNo,callback:function(t){e.channelNo=t},expression:"channelNo"}},e._l(e.selectList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"时间:"}},[a("el-date-picker",{attrs:{type:"datetimerange","unlink-panels":"","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.pickTime,callback:function(t){e.pickTime=t},expression:"pickTime"}})],1),e._v(" "),a("el-form-item",{staticClass:"hideBorder"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchAction}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"info",icon:"el-icon-delete"},on:{click:e.clearUp}},[e._v("清空")]),e._v(" "),e.hiddenAdd?e._e():a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addNewRole}},[e._v("添加"+e._s(e.whatName))])],1)],1),e._v(" "),a("div",{staticClass:"tags"})],1)}),[],!1,null,null,null);t.a=i.exports},eEzE:function(e,t,a){"use strict";a.r(t);var l=a("BLAu"),n=a("VwIl"),i={name:"alarmHistory",data:function(){return{input1:{},searchUser:"",selectList:"",tableData:[],totalNum:0,pageSize:20,alarmTypes:[],showDialog:!1,pageNow:1,message:{},resultArr:[{label:"未处理",value:"N",text:"未处理"},{label:"已处理",value:"Y",text:"已处理"}],channelList:[]}},mounted:function(){this.getAlarmType()},methods:{filterResult:function(e,t){return t.processingResult===e},filterAlarmType:function(e,t){return t.alarmType===e},showResult:function(e){var t="";return this.resultArr.forEach((function(a,l){a.value===e&&(t=a.label)})),t},updateOne:function(e){var t=this;this.tableData.forEach((function(a,l){a.guid===e.guid&&t.$set(t.tableData,l,e)}))},editCallback:function(){this.showDialog=!1},editOne:function(e){this.message=this.copySimple(e),this.showDialog=!0},getAlarmType:function(){var e=this;this.$request.getAlarmType().then((function(t){var a=t.data,l=[];a.forEach((function(e,t){var a={};a.label=e.value,a.text=e.value,a.value=e.key,l.push(a)})),console.log(l),e.alarmTypes=l,e.getChannels()}))},getOneAlarmType:function(e){var t="";return this.alarmTypes.forEach((function(a,l){a.value===e&&(t=a.label)})),t},getChannels:function(){var e=this;this.$request.getAllChannelData().then((function(t){var a=t.data;a&&a.length&&a.forEach((function(e,t){a[t].label=e.channelName,a[t].text=e.channelName,a[t].value=e.channelNo})),e.channelList=a,e.getTableData()}))},filterChannelNo:function(e,t){return t.channelNo===e},showChannelName:function(e){var t="";return this.channelList&&this.channelList.length&&this.channelList.forEach((function(a,l){a.channelNo===e&&(t=a.channelName)})),t||e},filterType:function(e,t){return t.userState===e},handleCurrentChange:function(e){this.pageNow=e,this.getTableData()},getTableData:function(){var e=this;this.$request.getAlarmHistory({data:this.input1,size:this.pageSize,current:this.pageNow}).then((function(t){e.tableData=t.data.data,e.totalNum=t.data.total}))},searchAction:function(e){this.input1={channelNo:e.select2,alarmType:e.channelNo,alarmTimeStart:e.pickTime[0],alarmTimeEnd:e.pickTime[1]},this.pageNow=1,this.getTableData()},clearUp:function(){this.input1={},this.pageNow=1,this.getTableData()}},components:{SearchTap:l.a,Edittap:n.a}},r=(a("vd8B"),a("KHd+")),s=Object(r.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("SearchTap",{attrs:{searchName:"搜索",whatName:"用户",select2Name:"通道",selectList2:e.channelList,hideSelect2:"",selectName:"报警类型",selectList:e.alarmTypes,hiddenAdd:""},on:{searchAction:e.searchAction,clearUp:e.clearUp}}),e._v(" "),a("div",{},[a("el-table",{ref:"tableAutoMaxHeight",attrs:{size:"small","max-height":e.tableMaxHeight,data:e.tableData}},[a("el-table-column",{attrs:{prop:"alarmTime",label:"报警时间",sortable:"",width:"164"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.$getLocalTime(t.row.alarmTime))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"alarmContent",label:"报警内容","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"alarmType",label:"报警类型",filters:e.alarmTypes,"filter-method":e.filterAlarmType,sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.getOneAlarmType(t.row.alarmType))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"channelName",label:"通道",sortable:"",filters:e.channelList,"filter-method":e.filterChannelNo}}),e._v(" "),a("el-table-column",{attrs:{prop:"processingPerson",label:"处理人",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"processingContent",label:"处理内容",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"processingResult",label:"处理结果",filters:e.resultArr,"filter-method":e.filterResult,sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.showResult(t.row.processingResult))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"processingTime",label:"时间",sortable:"",width:"164"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.$getLocalTime(t.row.processingTime))+"\n          ")]}}])}),e._v(" "),e.$showColumn(["edit"])?a("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Icon",{directives:[{name:"stat",rawName:"v-stat",value:"edit",expression:"'edit'"}],attrs:{icon:"icon-bianji",tip:"编辑"},nativeOn:{click:function(a){return e.editOne(t.row)}}})]}}],null,!1,2436503993)}):e._e()],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pageNow,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalNum},on:{"size-change":e.$handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.pageNow=t},"update:current-page":function(t){e.pageNow=t}}})],1),e._v(" "),e.showDialog?a("Edittap",{attrs:{channelType:e.channelList,resultArr:e.resultArr,alarmTypes:e.alarmTypes,message2:e.message,dialogVisible:e.showDialog},on:{updateOne:e.updateOne,editCallback:e.editCallback}}):e._e()],1)}),[],!1,null,"56abc018",null);t.default=s.exports},uZ5c:function(e,t,a){"use strict";a("4oD0")},vd8B:function(e,t,a){"use strict";a("wpuO")},wpuO:function(e,t,a){}}]);